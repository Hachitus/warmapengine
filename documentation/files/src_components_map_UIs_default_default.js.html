<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src\components\map\UIs\default\default.js - FlaTWorld</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="FlaTWorld" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/baseEventlisteners.html">baseEventlisteners</a></li>
                                <li><a href="../classes/eventListeners.html">eventListeners</a></li>
                                <li><a href="../classes/generalUtils.polyfills.html">generalUtils.polyfills</a></li>
                                <li><a href="../classes/hexagonPlugin.ObjectHexaTerrain.html">hexagonPlugin.ObjectHexaTerrain</a></li>
                                <li><a href="../classes/hexagonPlugin.ObjectHexaUnit.html">hexagonPlugin.ObjectHexaUnit</a></li>
                                <li><a href="../classes/hexagonPlugin.setupHexagonClick.html">hexagonPlugin.setupHexagonClick</a></li>
                                <li><a href="../classes/hexagonPlugin.setupObject_select_hexagon.html">hexagonPlugin.setupObject_select_hexagon</a></li>
                                <li><a href="../classes/hexagonPlugin.utils.html">hexagonPlugin.utils</a></li>
                                <li><a href="../classes/log.html">log</a></li>
                                <li><a href="../classes/Map.html">Map</a></li>
                                <li><a href="../classes/MapDataManipulator.html">MapDataManipulator</a></li>
                                <li><a href="../classes/mapDrag.html">mapDrag</a></li>
                                <li><a href="../classes/mapEvents.html">mapEvents</a></li>
                                <li><a href="../classes/MapLayer.html">MapLayer</a></li>
                                <li><a href="../classes/MapLayerParent.html">MapLayerParent</a></li>
                                <li><a href="../classes/mapMovement.html">mapMovement</a></li>
                                <li><a href="../classes/MapSubcontainer.html">MapSubcontainer</a></li>
                                <li><a href="../classes/mapZoom.html">mapZoom</a></li>
                                <li><a href="../classes/Object_sprite.html">Object_sprite</a></li>
                                <li><a href="../classes/ObjectManager.html">ObjectManager</a></li>
                                <li><a href="../classes/ObjectSpriteTerrain.html">ObjectSpriteTerrain</a></li>
                                <li><a href="../classes/ObjectSpriteUnit.html">ObjectSpriteUnit</a></li>
                                <li><a href="../classes/Preload.html">Preload</a></li>
                                <li><a href="../classes/UI.html">UI</a></li>
                                <li><a href="../classes/UI_default.html">UI_default</a></li>
                                <li><a href="../classes/UI_templateBase.html">UI_templateBase</a></li>
                                <li><a href="../classes/utilities.arrays.html">utilities.arrays</a></li>
                                <li><a href="../classes/utilities.environmentDetections.html">utilities.environmentDetections</a></li>
                                <li><a href="../classes/utils.dataManipulation.html">utils.dataManipulation</a></li>
                                <li><a href="../classes/utils.effects.html">utils.effects</a></li>
                                <li><a href="../classes/utils.environment.html">utils.environment</a></li>
                                <li><a href="../classes/utils.general.html">utils.general</a></li>
                                <li><a href="../classes/utils.mouse.html">utils.mouse</a></li>
                                <li><a href="../classes/utils.Quadtree.html">utils.Quadtree</a></li>
                                <li><a href="../classes/utils.resize.html">utils.resize</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src\components\map\UIs\default\default.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/* global $ */

&#x27;use strict&#x27;;

/*---------------------
------- IMPORT --------
----------------------*/
import $ from &#x27;assets/lib/jquery/jquery-css-ajax-effects.min.js&#x27;;
import { templates } from &#x27;components/map/UIs/default/layout/templates&#x27;;
import { createVisibleHexagon } from &#x27;components/map/extensions/hexagons/utils/createHexagon&#x27;;
import { UI_templateBase, UI } from &#x27;bundles/coreBundle&#x27;;
//import { drawShapes } from &#x27;components/map/UIs/default/utils/arrows&#x27;;

/*---------------------
------ VARIABLES ------
----------------------*/
const FADE_ANIMATION = &quot;slow&quot;;
var cssClasses = {
  select: &quot;#dialog_select&quot;
};
var $elements = {};

/*---------------------
--------- API ---------
----------------------*/
export class UI_default extends UI_templateBase {
  /**
   * The simplest default UI implementation. Implemented UI functionalities for: showSelections, highlightSelectedObject
   *
   * @class UI_default
   * @constructor
   * @requires Handlebars
   * @requires jQuery
   * @todo  should take jQuery away from this, as soon as we refactor the animations and graphics for selections
   * @param  {HTMLElement} modal
   * @param  {Map} map
   * @param  {Object} options
   */
  constructor(modal, map, options = { styles: &quot;#F0F0F0&quot; }) {
    super(cssClasses);
    // Add a media (and/or media query) here if you&#x27;d like!
    // style.setAttribute(&quot;media&quot;, &quot;screen&quot;)
    // style.setAttribute(&quot;media&quot;, &quot;only screen and (max-width : 1024px)&quot;)

    this.map = map;
    this.modal = modal || document.getElementById(&quot;dialog_select&quot;);
    this.styles = options.styles;
  }
  /**
   * @method getTemplates
   * Required by the map/core/UI.js API
   */
  getTemplates() {
    return templates;
  }
  /**
   * Required by the map.UI API
   *
   * @method showSelections
   * @param  {Object} objects     Objects that have been selected. See core.UI for more information
   * @param {Object} getDatas       See explanation in core.UI
   * @param {Object} options        Extra options
   */
  showSelections(objects, getDatas, options) {
    var updateCB = this.map.drawOnNextTick.bind(this.map);
    var UILayer = this.map.getMovableLayer();
    var cb;

    /* We add the objects to be highlighted to the correct UI layer */
    //objectsToUI(UILayer, objects);

    if (objects &amp;&amp; objects.length &gt; 1) {
      cb = () =&gt; {
        this.modal.innerHTML = templates.multiSelection({
          title: &quot;Objects&quot;,
          objects
        });

        this.showModal(this.modal, cssClasses);

        console.log(objects);

        _get$Element(&quot;select&quot;).fadeIn(FADE_ANIMATION);
      };
    } else if (objects.length === 1) {
      cb = () =&gt; {
        this.highlightSelectedObject(objects[0]);

        console.log(objects);
      };
    } else {
      cb = () =&gt; {
        UILayer.emptyUIObjects();
        updateCB();
        console.log(&quot;Error occured selecting the objects on this coordinates! Nothing found&quot;);
      };
    }

    _get$Element(&quot;select&quot;).fadeOut(FADE_ANIMATION, cb);
  }
  /**
   * Required by the map.UI API
   *
   * @method highlightSelectedObject
   * @param  {Object} object        Object that has been selected. See core.UI for more information
   * @param {Object} getDatas       See explanation in core.UI
   * @param {Object} options        Extra options. Like dropping a shadow etc.
   */
  highlightSelectedObject(object, getDatas, options = {shadow: { color: &quot;0x0000&quot;, distance: 5, alpha: 0.55, angle: 45, blur: 5 }}) {
    var { shadow } = options;
    var highlightableObject, objectDatas;

    objectDatas = getDatas.allData(object);

    this.modal.innerHTML = templates.singleSelection({
      title: &quot;Selected&quot;,
      object: {
        name: objectDatas.name
      }
    });
    this.showModal(this.modal, cssClasses);

    highlightableObject = this._highlightSelectedObject(object, this.map.getRenderer());

    highlightableObject.dropShadow({
      color: shadow.color,
      distance: shadow.distance,
      alpha: shadow.alpha,
      angle: shadow.angle,
      blur: shadow.blur
    });

    this.map.drawOnNextTick();

    _get$Element(&quot;select&quot;).fadeIn(FADE_ANIMATION);

    return highlightableObject;
  }
  /**
   * @method showUnitMovement
   */
  showUnitMovement() {}
  /**
   * @method init
   */
  init() {}

  /*----------------------
  ------- PRIVATE --------
  ----------------------*/
  /**
   * @private
   * @static
   * @method _highlightSelectedObject
   * @param  {Object} object
   * @param  {MapLayer} movableLayer
   * @param  {PIXI.Renderer} renderer
   */
  _highlightSelectedObject(object, renderer) {
    var movableLayer = this.map.getMovableLayer();
    var clonedObject;

    clonedObject = object.clone(renderer);
    clonedObject.__proto__ = object.__proto__;

    var coord = object.toGlobal(new PIXI.Point(0,0));
    coord = movableLayer.toLocal(coord);

    coord.x -= object.width * object.anchor.x;
    coord.y -= object.height * object.anchor.y;

    this.createHighlight(clonedObject, { coords: coord });

    return clonedObject;
  }
  /**
   * @private
   * @static
   * @method createHighlight
   */
  createHighlight(object, options = { coords: new PIXI.Point(0, 0) }) {
    var radius = 47;
    var movableLayer = this.map.getMovableLayer();
    var container = new this.map.createSpecialLayer(&quot;UILayer&quot;, { toLayer: movableLayer});
    var objCoords = {
      x: Number(object.x),
      y: Number(object.y)
    };
    var highlighterObject;

    highlighterObject = createVisibleHexagon(radius, { color: &quot;#F0F0F0&quot; });
    highlighterObject.x = objCoords.x + 32;
    highlighterObject.y = objCoords.y + 27;

    highlighterObject.alpha = 0.5;

    /* We add the children first to subcontainer, since it&#x27;s much easier to handle the x and y in it, rather than
     * handle graphics x and y */
    container.addChild(highlighterObject);
    container.addChild(object);

    container.position = options.coords;

    this.map.removeUIObject(this.map.layerTypes.movableType.id, [container])
    this.map.addUIObjects(this.map.layerTypes.movableType.id, [container]);
  }

}

/*----------------------
------- PRIVATE --------
----------------------*/
/**
 * @private
 * @static
 * @method _get$Element
 * @param  {[type]} which [description]
 * @return {[type]}       [description]
 */
function _get$Element(which) {
  /* Set the jQuery element to collection only once */
  if (!$elements[which]) {
    let $element = $(cssClasses[which]);
    $elements[which] = $element;
  }

  return $elements[which];
}
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
